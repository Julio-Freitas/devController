"use strict";(()=>{var e={};e.id=191,e.ids=[191],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},89485:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>g,originalPathname:()=>Z,patchFetch:()=>f,requestAsyncStorage:()=>h,routeModule:()=>x,serverHooks:()=>v,staticGenerationAsyncStorage:()=>q,staticGenerationBailout:()=>j});var s={};t.r(s),t.d(s,{DELETE:()=>m,GET:()=>l,POST:()=>d});var o=t(95419),i=t(69108),n=t(99678),a=t(82002),u=t(81355),c=t(78070),p=t(19631);async function d(e){let r=await (0,u.getServerSession)(a.L);if(!r||!r.user)return c.Z.json({error:"Not Authorized"},{status:401});try{let{name:r,email:t,phone:s,address:o,userId:i}=await e.json();await p.Z.customer.create({data:{name:r,email:t,phone:s,address:o??"",userId:i}})}catch(e){return c.Z.json({error:"Fail in create new user!"},{status:400})}return c.Z.json({message:"CADASTRO"})}async function l(e){let r=await (0,u.getServerSession)(a.L);if(!r||!r.user)return c.Z.json({error:"Not Authorized"},{status:401});let t=await p.Z.customer.findMany({where:{userId:r.user.id}});return c.Z.json({data:t,req:e})}async function m(e){let r=await (0,u.getServerSession)(a.L);if(!r||!r.user)return c.Z.json({error:"Not Authorized"},{status:401});let{searchParams:t}=new URL(e.url),s=t.get("id");if(!s)return c.Z.json({error:"Not Found Customer"},{status:401});if(await p.Z.ticket.findFirst({where:{id:r.user.id}}))return c.Z.json({error:"Falied delete customer. This customer has open tickets."},{status:401});try{return await p.Z.customer.delete({where:{id:s}}),c.Z.json({message:"Delete customer!"})}catch(e){return c.Z.json({error:"Falied delete customer"},{status:401})}}let x=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/customer/route",pathname:"/api/customer",filename:"route",bundlePath:"app/api/customer/route"},resolvedPagePath:"/home/julio/devController/src/app/api/customer/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:q,serverHooks:v,headerHooks:g,staticGenerationBailout:j}=x,Z="/api/customer/route";function f(){return(0,n.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:q})}},82002:(e,r,t)=>{t.d(r,{L:()=>n});var s=t(65822),o=t(10375),i=t(19631);let n={adapter:(0,s.N)(i.Z),providers:[(0,o.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})],callbacks:{session:async({session:e,token:r,user:t})=>(e.user={...e.user,id:t.id},e)},secret:process.env.NEXT_AUTH_SECRET}},19631:(e,r,t)=>{t.d(r,{Z:()=>s});let s=new(require("@prisma/client")).PrismaClient}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,217,319],()=>t(89485));module.exports=s})();